<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Module: Prawn::Document::Internals
  
    &mdash; Prawn Documentation
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../../';
  framesUrl = "../../frames.html#!" + escape(window.location.href);
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../../_index.html">Index (I)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../Prawn.html" title="Prawn (module)">Prawn</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Document.html" title="Prawn::Document (class)">Document</a></span></span>
     &raquo; 
    <span class="title">Internals</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Module: Prawn::Document::Internals
  
  
  
</h1>

<dl class="box">
  
  
    
  
    
  
  
    <dt class="r1">Included in:</dt>
    <dd class="r1"><span class='object_link'><a href="../Document.html" title="Prawn::Document (class)">Prawn::Document</a></span></dd>
    
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">lib/prawn/document/internals.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>This module exposes a few low-level PDF features for those who want to
extend Prawn&#39;s core functionality.  If you are not comfortable with low
level PDF functionality as defined by Adobe&#39;s specification, chances
are you won&#39;t need anything you find here.</p>


  </div>
</div>
<div class="tags">
  

</div>






  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_content-instance_method" title="#add_content (instance method)">- (Object) <strong>add_content</strong>(str) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Appends a raw string to the current page content.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#before_render-instance_method" title="#before_render (instance method)">- (Object) <strong>before_render</strong>(&amp;block) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Defines a block to be called just before the document is rendered.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#deref-instance_method" title="#deref (instance method)">- (Object) <strong>deref</strong>(obj) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>At any stage in the object tree an object can be replaced with an indirect
reference.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#names-instance_method" title="#names (instance method)">- (Object) <strong>names</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The Name dictionary (PDF spec 3.6.3) for this document.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#names%3F-instance_method" title="#names? (instance method)">- (Boolean) <strong>names?</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns true if the Names dictionary is in use for this document.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#on_page_create-instance_method" title="#on_page_create (instance method)">- (Object) <strong>on_page_create</strong>(&amp;block) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Defines a block to be called just before a new page is started.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#ref-instance_method" title="#ref (instance method)">- (Object) <strong>ref</strong>(data) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Creates a new Prawn::Reference and adds it to the Document&#39;s object
list.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#ref%21-instance_method" title="#ref! (instance method)">- (Object) <strong>ref!</strong>(data) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Like ref, but returns the actual reference instead of its identifier.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="add_content-instance_method">
  
    - (<tt>Object</tt>) <strong>add_content</strong>(str) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Appends a raw string to the current page content.</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># Raw line drawing example:
</span><span class='id identifier rubyid_x1'>x1</span><span class='comma'>,</span><span class='id identifier rubyid_y1'>y1</span><span class='comma'>,</span><span class='id identifier rubyid_x2'>x2</span><span class='comma'>,</span><span class='id identifier rubyid_y2'>y2</span> <span class='op'>=</span> <span class='int'>100</span><span class='comma'>,</span><span class='int'>500</span><span class='comma'>,</span><span class='int'>300</span><span class='comma'>,</span><span class='int'>550</span>
<span class='id identifier rubyid_pdf'>pdf</span><span class='period'>.</span><span class='id identifier rubyid_add_content'>add_content</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%.3f %.3f m</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> <span class='lbracket'>[</span> <span class='id identifier rubyid_x1'>x1</span><span class='comma'>,</span> <span class='id identifier rubyid_y1'>y1</span> <span class='rbracket'>]</span><span class='rparen'>)</span>  <span class='comment'># move
</span><span class='id identifier rubyid_pdf'>pdf</span><span class='period'>.</span><span class='id identifier rubyid_add_content'>add_content</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%.3f %.3f l</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> <span class='lbracket'>[</span> <span class='id identifier rubyid_x2'>x2</span><span class='comma'>,</span> <span class='id identifier rubyid_y2'>y2</span> <span class='rbracket'>]</span><span class='rparen'>)</span>  <span class='comment'># draw path
</span><span class='id identifier rubyid_pdf'>pdf</span><span class='period'>.</span><span class='id identifier rubyid_add_content'>add_content</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>S</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='comment'># stroke</span></code></pre>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


56
57
58
59</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/prawn/document/internals.rb', line 56</span>

<span class='kw'>def</span> <span class='id identifier rubyid_add_content'>add_content</span><span class='lparen'>(</span><span class='id identifier rubyid_str'>str</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_save_graphics_state'>save_graphics_state</span> <span class='kw'>if</span> <span class='id identifier rubyid_graphic_state'>graphic_state</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='id identifier rubyid_state'>state</span><span class='period'>.</span><span class='id identifier rubyid_page'>page</span><span class='period'>.</span><span class='id identifier rubyid_content'>content</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_str'>str</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="before_render-instance_method">
  
    - (<tt>Object</tt>) <strong>before_render</strong>(&amp;block) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Defines a block to be called just before the document is rendered.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


77
78
79</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/prawn/document/internals.rb', line 77</span>

<span class='kw'>def</span> <span class='id identifier rubyid_before_render'>before_render</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_state'>state</span><span class='period'>.</span><span class='id identifier rubyid_before_render_callbacks'>before_render_callbacks</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_block'>block</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="deref-instance_method">
  
    - (<tt>Object</tt>) <strong>deref</strong>(obj) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>At any stage in the object tree an object can be replaced with an indirect
reference. To get access to the object safely, regardless of if it&#39;s
hidden behind a Prawn::Reference, wrap it in deref().</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


44
45
46</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/prawn/document/internals.rb', line 44</span>

<span class='kw'>def</span> <span class='id identifier rubyid_deref'>deref</span><span class='lparen'>(</span><span class='id identifier rubyid_obj'>obj</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_obj'>obj</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>PDF</span><span class='op'>::</span><span class='const'>Core</span><span class='op'>::</span><span class='const'>Reference</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='id identifier rubyid_obj'>obj</span><span class='period'>.</span><span class='id identifier rubyid_data'>data</span> <span class='op'>:</span> <span class='id identifier rubyid_obj'>obj</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="names-instance_method">
  
    - (<tt>Object</tt>) <strong>names</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The Name dictionary (PDF spec 3.6.3) for this document. It is lazily
initialized, so that documents that do not need a name dictionary do not
incur the additional overhead.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


65
66
67</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/prawn/document/internals.rb', line 65</span>

<span class='kw'>def</span> <span class='id identifier rubyid_names'>names</span>
  <span class='id identifier rubyid_state'>state</span><span class='period'>.</span><span class='id identifier rubyid_store'>store</span><span class='period'>.</span><span class='id identifier rubyid_root'>root</span><span class='period'>.</span><span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='symbol'>:Names</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='id identifier rubyid_ref!'>ref!</span><span class='lparen'>(</span><span class='symbol'>:Type</span> <span class='op'>=&gt;</span> <span class='symbol'>:Names</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="names?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>names?</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns true if the Names dictionary is in use for this document.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


71
72
73</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/prawn/document/internals.rb', line 71</span>

<span class='kw'>def</span> <span class='id identifier rubyid_names?'>names?</span>
  <span class='id identifier rubyid_state'>state</span><span class='period'>.</span><span class='id identifier rubyid_store'>store</span><span class='period'>.</span><span class='id identifier rubyid_root'>root</span><span class='period'>.</span><span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='symbol'>:Names</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="on_page_create-instance_method">
  
    - (<tt>Object</tt>) <strong>on_page_create</strong>(&amp;block) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Defines a block to be called just before a new page is started.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


83
84
85
86
87
88
89</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/prawn/document/internals.rb', line 83</span>

<span class='kw'>def</span> <span class='id identifier rubyid_on_page_create'>on_page_create</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
   <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
      <span class='id identifier rubyid_state'>state</span><span class='period'>.</span><span class='id identifier rubyid_on_page_create_callback'>on_page_create_callback</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span>
   <span class='kw'>else</span>
      <span class='id identifier rubyid_state'>state</span><span class='period'>.</span><span class='id identifier rubyid_on_page_create_callback'>on_page_create_callback</span> <span class='op'>=</span> <span class='kw'>nil</span>
   <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="ref-instance_method">
  
    - (<tt>Object</tt>) <strong>ref</strong>(data) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Creates a new Prawn::Reference and adds it to the Document&#39;s object
list.  The <code>data</code> argument is anything that Prawn::PdfObject()
can convert.</p>

<p>Returns the identifier which points to the reference in the ObjectStore</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


24
25
26</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/prawn/document/internals.rb', line 24</span>

<span class='kw'>def</span> <span class='id identifier rubyid_ref'>ref</span><span class='lparen'>(</span><span class='id identifier rubyid_data'>data</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_ref!'>ref!</span><span class='lparen'>(</span><span class='id identifier rubyid_data'>data</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_identifier'>identifier</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="ref!-instance_method">
  
    - (<tt>Object</tt>) <strong>ref!</strong>(data) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Like ref, but returns the actual reference instead of its identifier.</p>

<p>While you can use this to build up nested references within the object
tree, it is recommended to persist only identifiers, and them provide
helper methods to look up the actual references in the ObjectStore if
needed.  If you take this approach, Prawn::Document::Snapshot will probably
work with your extension</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


36
37
38</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/prawn/document/internals.rb', line 36</span>

<span class='kw'>def</span> <span class='id identifier rubyid_ref!'>ref!</span><span class='lparen'>(</span><span class='id identifier rubyid_data'>data</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_state'>state</span><span class='period'>.</span><span class='id identifier rubyid_store'>store</span><span class='period'>.</span><span class='id identifier rubyid_ref'>ref</span><span class='lparen'>(</span><span class='id identifier rubyid_data'>data</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Fri Jan 17 12:56:35 2014 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7.3 (ruby-2.0.0).
</div>

  </body>
</html>