<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Module: Prawn::Core</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Module</strong></td>
          <td class="class-name-in-header">Prawn::Core</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../files/lib/prawn/security_rb.html">
                lib/prawn/security.rb
                </a>
        <br />
                <a href="../../files/lib/prawn/core/destinations_rb.html">
                lib/prawn/core/destinations.rb
                </a>
        <br />
                <a href="../../files/lib/prawn/core/byte_string_rb.html">
                lib/prawn/core/byte_string.rb
                </a>
        <br />
                <a href="../../files/lib/prawn/core/object_store_rb.html">
                lib/prawn/core/object_store.rb
                </a>
        <br />
                <a href="../../files/lib/prawn/core/page_rb.html">
                lib/prawn/core/page.rb
                </a>
        <br />
                <a href="../../files/lib/prawn/core/annotations_rb.html">
                lib/prawn/core/annotations.rb
                </a>
        <br />
                <a href="../../files/lib/prawn/core/text_rb.html">
                lib/prawn/core/text.rb
                </a>
        <br />
                <a href="../../files/lib/prawn/core/document_state_rb.html">
                lib/prawn/core/document_state.rb
                </a>
        <br />
                <a href="../../files/lib/prawn/core/reference_rb.html">
                lib/prawn/core/reference.rb
                </a>
        <br />
                <a href="../../files/lib/prawn/core/name_tree_rb.html">
                lib/prawn/core/name_tree.rb
                </a>
        <br />
                <a href="../../files/lib/prawn/core/pdf_object_rb.html">
                lib/prawn/core/pdf_object.rb
                </a>
        <br />
                <a href="../../files/lib/prawn/core/literal_string_rb.html">
                lib/prawn/core/literal_string.rb
                </a>
        <br />
            </td>
        </tr>

        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">



   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000012">EncryptedPdfObject</a>&nbsp;&nbsp;
      <a href="#M000013">PdfObject</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">

    <div id="class-list">
      <h3 class="section-bar">Classes and Modules</h3>

      Module <a href="Core/Annotations.html" class="link">Prawn::Core::Annotations</a><br />
Module <a href="Core/Destinations.html" class="link">Prawn::Core::Destinations</a><br />
Class <a href="Core/DocumentState.html" class="link">Prawn::Core::DocumentState</a><br />

    </div>




      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000012" class="method-detail">
        <a name="M000012"></a>

        <div class="method-heading">
          <a href="#M000012" class="method-signature">
          <span class="method-name">EncryptedPdfObject</span><span class="method-args">(obj, key, id, gen, in_content_stream=false)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Like <a href="Core.html#M000013">PdfObject</a>, but returns an encrypted
result if required. For direct objects, requires the object identifier and
generation number from the indirect object referencing obj.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000012-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000012-source">
<pre>
<span class="ruby-comment cmt"># File lib/prawn/security.rb, line 203</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-constant">EncryptedPdfObject</span>(<span class="ruby-identifier">obj</span>, <span class="ruby-identifier">key</span>, <span class="ruby-identifier">id</span>, <span class="ruby-identifier">gen</span>, <span class="ruby-identifier">in_content_stream</span>=<span class="ruby-keyword kw">false</span>)
      <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">obj</span>
      <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Array</span>
        <span class="ruby-value str">&quot;[&quot;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">e</span><span class="ruby-operator">|</span>
            <span class="ruby-constant">EncryptedPdfObject</span>(<span class="ruby-identifier">e</span>, <span class="ruby-identifier">key</span>, <span class="ruby-identifier">id</span>, <span class="ruby-identifier">gen</span>, <span class="ruby-identifier">in_content_stream</span>)
        }.<span class="ruby-identifier">join</span>(<span class="ruby-value str">' '</span>) <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;]&quot;</span>
      <span class="ruby-keyword kw">when</span> <span class="ruby-constant">LiteralString</span>
        <span class="ruby-comment cmt"># FIXME: encrypted?</span>
        <span class="ruby-identifier">obj</span> = <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/[\\\n\(\)]/</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">m</span><span class="ruby-operator">|</span> <span class="ruby-node">&quot;\\#{m}&quot;</span> }
        <span class="ruby-node">&quot;(#{obj})&quot;</span>
      <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Time</span>
        <span class="ruby-comment cmt"># FIXME: encrypted?</span>
        <span class="ruby-identifier">obj</span> = <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">strftime</span>(<span class="ruby-value str">&quot;D:%Y%m%d%H%M%S%z&quot;</span>).<span class="ruby-identifier">chop</span>.<span class="ruby-identifier">chop</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;'00'&quot;</span>
        <span class="ruby-identifier">obj</span> = <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/[\\\n\(\)]/</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">m</span><span class="ruby-operator">|</span> <span class="ruby-node">&quot;\\#{m}&quot;</span> }
        <span class="ruby-node">&quot;(#{obj})&quot;</span>
      <span class="ruby-keyword kw">when</span> <span class="ruby-constant">String</span>
        <span class="ruby-constant">PdfObject</span>(
          <span class="ruby-constant">ByteString</span>.<span class="ruby-identifier">new</span>(
            <span class="ruby-constant">Document</span><span class="ruby-operator">::</span><span class="ruby-constant">Security</span>.<span class="ruby-identifier">encrypt_string</span>(<span class="ruby-identifier">obj</span>, <span class="ruby-identifier">key</span>, <span class="ruby-identifier">id</span>, <span class="ruby-identifier">gen</span>)),
          <span class="ruby-identifier">in_content_stream</span>)
      <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Hash</span>
        <span class="ruby-identifier">output</span> = <span class="ruby-value str">&quot;&lt;&lt; &quot;</span>
        <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
          <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">String</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">k</span> <span class="ruby-operator">||</span> <span class="ruby-constant">Symbol</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">k</span>
            <span class="ruby-identifier">raise</span> <span class="ruby-constant">Prawn</span><span class="ruby-operator">::</span><span class="ruby-constant">Errors</span><span class="ruby-operator">::</span><span class="ruby-constant">FailedObjectConversion</span>,
              <span class="ruby-value str">&quot;A PDF Dictionary must be keyed by names&quot;</span>
          <span class="ruby-keyword kw">end</span>
          <span class="ruby-identifier">output</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">PdfObject</span>(<span class="ruby-identifier">k</span>.<span class="ruby-identifier">to_sym</span>, <span class="ruby-identifier">in_content_stream</span>) <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot; &quot;</span> <span class="ruby-operator">&lt;&lt;</span>
                    <span class="ruby-constant">EncryptedPdfObject</span>(<span class="ruby-identifier">v</span>, <span class="ruby-identifier">key</span>, <span class="ruby-identifier">id</span>, <span class="ruby-identifier">gen</span>, <span class="ruby-identifier">in_content_stream</span>) <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;\n&quot;</span>
        <span class="ruby-keyword kw">end</span>
        <span class="ruby-identifier">output</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;&gt;&gt;&quot;</span>
      <span class="ruby-keyword kw">when</span> <span class="ruby-constant">NameTree</span><span class="ruby-operator">::</span><span class="ruby-constant">Value</span>
        <span class="ruby-constant">PdfObject</span>(<span class="ruby-identifier">obj</span>.<span class="ruby-identifier">name</span>) <span class="ruby-operator">+</span> <span class="ruby-value str">&quot; &quot;</span> <span class="ruby-operator">+</span>
          <span class="ruby-constant">EncryptedPdfObject</span>(<span class="ruby-identifier">obj</span>.<span class="ruby-identifier">value</span>, <span class="ruby-identifier">key</span>, <span class="ruby-identifier">id</span>, <span class="ruby-identifier">gen</span>, <span class="ruby-identifier">in_content_stream</span>)
      <span class="ruby-keyword kw">else</span> <span class="ruby-comment cmt"># delegate back to PdfObject</span>
        <span class="ruby-constant">PdfObject</span>(<span class="ruby-identifier">obj</span>, <span class="ruby-identifier">in_content_stream</span>)
      <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000013" class="method-detail">
        <a name="M000013"></a>

        <div class="method-heading">
          <a href="#M000013" class="method-signature">
          <span class="method-name">PdfObject</span><span class="method-args">(obj, in_content_stream = false)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Serializes Ruby objects to their PDF equivalents. Most primitive objects
will work as expected, but please note that Name objects are represented by
Ruby Symbol objects and Dictionary objects are represented by Ruby hashes
(keyed by symbols)
</p>
<pre>
 Examples:

    PdfObject(true)      #=&gt; &quot;true&quot;
    PdfObject(false)     #=&gt; &quot;false&quot;
    PdfObject(1.2124)    #=&gt; &quot;1.2124&quot;
    PdfObject(&quot;foo bar&quot;) #=&gt; &quot;(foo bar)&quot;
    PdfObject(:Symbol)   #=&gt; &quot;/Symbol&quot;
    PdfObject([&quot;foo&quot;,:bar, [1,2]]) #=&gt; &quot;[foo /bar [1 2]]&quot;
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000013-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000013-source">
<pre>
<span class="ruby-comment cmt"># File lib/prawn/core/pdf_object.rb, line 30</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-constant">PdfObject</span>(<span class="ruby-identifier">obj</span>, <span class="ruby-identifier">in_content_stream</span> = <span class="ruby-keyword kw">false</span>)
      <span class="ruby-keyword kw">case</span>(<span class="ruby-identifier">obj</span>)        
      <span class="ruby-keyword kw">when</span> <span class="ruby-constant">NilClass</span>   <span class="ruby-keyword kw">then</span> <span class="ruby-value str">&quot;null&quot;</span> 
      <span class="ruby-keyword kw">when</span> <span class="ruby-constant">TrueClass</span>  <span class="ruby-keyword kw">then</span> <span class="ruby-value str">&quot;true&quot;</span>
      <span class="ruby-keyword kw">when</span> <span class="ruby-constant">FalseClass</span> <span class="ruby-keyword kw">then</span> <span class="ruby-value str">&quot;false&quot;</span>
      <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Numeric</span>    <span class="ruby-keyword kw">then</span> <span class="ruby-constant">String</span>(<span class="ruby-identifier">obj</span>)
      <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Array</span>
        <span class="ruby-value str">&quot;[&quot;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">e</span><span class="ruby-operator">|</span> <span class="ruby-constant">PdfObject</span>(<span class="ruby-identifier">e</span>, <span class="ruby-identifier">in_content_stream</span>) }.<span class="ruby-identifier">join</span>(<span class="ruby-value str">' '</span>) <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;]&quot;</span>
      <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Prawn</span><span class="ruby-operator">::</span><span class="ruby-constant">Core</span><span class="ruby-operator">::</span><span class="ruby-constant">LiteralString</span>
        <span class="ruby-identifier">obj</span> = <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/[\\\n\(\)]/</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">m</span><span class="ruby-operator">|</span> <span class="ruby-node">&quot;\\#{m}&quot;</span> }
        <span class="ruby-node">&quot;(#{obj})&quot;</span>
      <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Time</span>
        <span class="ruby-identifier">obj</span> = <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">strftime</span>(<span class="ruby-value str">&quot;D:%Y%m%d%H%M%S%z&quot;</span>).<span class="ruby-identifier">chop</span>.<span class="ruby-identifier">chop</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;'00'&quot;</span>
        <span class="ruby-identifier">obj</span> = <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/[\\\n\(\)]/</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">m</span><span class="ruby-operator">|</span> <span class="ruby-node">&quot;\\#{m}&quot;</span> }
        <span class="ruby-node">&quot;(#{obj})&quot;</span>
      <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Prawn</span><span class="ruby-operator">::</span><span class="ruby-constant">Core</span><span class="ruby-operator">::</span><span class="ruby-constant">ByteString</span>
        <span class="ruby-value str">&quot;&lt;&quot;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">unpack</span>(<span class="ruby-value str">&quot;H*&quot;</span>).<span class="ruby-identifier">first</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;&gt;&quot;</span>
      <span class="ruby-keyword kw">when</span> <span class="ruby-constant">String</span>
        <span class="ruby-identifier">obj</span> = <span class="ruby-value str">&quot;\xFE\xFF&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">unpack</span>(<span class="ruby-value str">&quot;U*&quot;</span>).<span class="ruby-identifier">pack</span>(<span class="ruby-value str">&quot;n*&quot;</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">in_content_stream</span>
        <span class="ruby-value str">&quot;&lt;&quot;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">unpack</span>(<span class="ruby-value str">&quot;H*&quot;</span>).<span class="ruby-identifier">first</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;&gt;&quot;</span>
       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Symbol</span>                                                         
         <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">obj</span> = <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">to_s</span>) <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/\s/</span>
           <span class="ruby-identifier">raise</span> <span class="ruby-constant">Prawn</span><span class="ruby-operator">::</span><span class="ruby-constant">Errors</span><span class="ruby-operator">::</span><span class="ruby-constant">FailedObjectConversion</span>, 
             <span class="ruby-value str">&quot;A PDF Name cannot contain whitespace&quot;</span>  
         <span class="ruby-keyword kw">else</span>
           <span class="ruby-value str">&quot;/&quot;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">obj</span>   
         <span class="ruby-keyword kw">end</span> 
      <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Hash</span>           
        <span class="ruby-identifier">output</span> = <span class="ruby-value str">&quot;&lt;&lt; &quot;</span>
        <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span>  
          <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">String</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">k</span> <span class="ruby-operator">||</span> <span class="ruby-constant">Symbol</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">k</span>
            <span class="ruby-identifier">raise</span> <span class="ruby-constant">Prawn</span><span class="ruby-operator">::</span><span class="ruby-constant">Errors</span><span class="ruby-operator">::</span><span class="ruby-constant">FailedObjectConversion</span>, 
              <span class="ruby-value str">&quot;A PDF Dictionary must be keyed by names&quot;</span>
          <span class="ruby-keyword kw">end</span>                          
          <span class="ruby-identifier">output</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">PdfObject</span>(<span class="ruby-identifier">k</span>.<span class="ruby-identifier">to_sym</span>, <span class="ruby-identifier">in_content_stream</span>) <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot; &quot;</span> <span class="ruby-operator">&lt;&lt;</span> 
                    <span class="ruby-constant">PdfObject</span>(<span class="ruby-identifier">v</span>, <span class="ruby-identifier">in_content_stream</span>) <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;\n&quot;</span>
        <span class="ruby-keyword kw">end</span>  
        <span class="ruby-identifier">output</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;&gt;&gt;&quot;</span>  
      <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Prawn</span><span class="ruby-operator">::</span><span class="ruby-constant">Core</span><span class="ruby-operator">::</span><span class="ruby-constant">Reference</span>
        <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">to_s</span>      
      <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Prawn</span><span class="ruby-operator">::</span><span class="ruby-constant">Core</span><span class="ruby-operator">::</span><span class="ruby-constant">NameTree</span><span class="ruby-operator">::</span><span class="ruby-constant">Node</span>
        <span class="ruby-constant">PdfObject</span>(<span class="ruby-identifier">obj</span>.<span class="ruby-identifier">to_hash</span>)
      <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Prawn</span><span class="ruby-operator">::</span><span class="ruby-constant">Core</span><span class="ruby-operator">::</span><span class="ruby-constant">NameTree</span><span class="ruby-operator">::</span><span class="ruby-constant">Value</span>
        <span class="ruby-constant">PdfObject</span>(<span class="ruby-identifier">obj</span>.<span class="ruby-identifier">name</span>) <span class="ruby-operator">+</span> <span class="ruby-value str">&quot; &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-constant">PdfObject</span>(<span class="ruby-identifier">obj</span>.<span class="ruby-identifier">value</span>)
      <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Prawn</span><span class="ruby-operator">::</span><span class="ruby-constant">OutlineRoot</span>, <span class="ruby-constant">Prawn</span><span class="ruby-operator">::</span><span class="ruby-constant">OutlineItem</span>
        <span class="ruby-constant">PdfObject</span>(<span class="ruby-identifier">obj</span>.<span class="ruby-identifier">to_hash</span>)
      <span class="ruby-keyword kw">else</span>
        <span class="ruby-identifier">raise</span> <span class="ruby-constant">Prawn</span><span class="ruby-operator">::</span><span class="ruby-constant">Errors</span><span class="ruby-operator">::</span><span class="ruby-constant">FailedObjectConversion</span>, 
          <span class="ruby-value str">&quot;This object cannot be serialized to PDF&quot;</span>
      <span class="ruby-keyword kw">end</span>     
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>